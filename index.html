<html>
<head>
  <title>Demo Social Service</title>
  <link id="siteicon" rel="icon" href="./firefox.png"/>
  <script src="./manifest.js" type="text/javascript"></script>

<script>
var loc = location.href;
var baseurl = loc.substring(0,loc.lastIndexOf('/'));

function activate(node) {
  var manifest = getManifest();
  manifest.version++;
  var uMatch = navigator.userAgent.match(/Firefox\/(.*)$/),
    ffVersion;
  if (uMatch && uMatch.length > 1) {
    ffVersion = uMatch[1];
  }
  var event = new CustomEvent("ActivateSocialFeature");
  if (parseInt(ffVersion) == 21) {
    document.dispatchEvent(event); // required for fx21
  } else {
    node.setAttribute("data-service", JSON.stringify(manifest));
    node.dispatchEvent(event);
  }
  // second activation will add the shareURL
  manifest.shareURL = baseurl+"/share.html#%{url}"
}
</script>
</head>
<body>

nothing to see here

<!-- activation requires user input, first button works, second does not. -->
<button onclick="activate(this)" title="activate the demo provider">Activate The Demo Provider</button>
<!-- next button illustrates that activation requires user input,
     otherwise it will be ignored by the browser -->
<button onclick="setTimeout(activate, 1000, this)">Auto Activate provider without user input (should fail)</button>

<p>Activation is only available to domains that are whitelisted in Firefox
preferences.  See social.activation.whitelist in about:config.</p>
</body>
</html>
